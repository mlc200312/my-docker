#!/bin/bash
# filename: uninstall.sh
# 描述：一键卸载开发环境容器服务（包含RabbitMQ、MySQL、Redis、Nacos）
# 版本：1.1.0
# 作者：Min
# 最后更新：2025-08-29

#######################################
# 容器服务卸载
# 执行步骤：
#   1. 停止并删除容器（-v同时删除关联卷）
# 注意事项：
#   - 该操作不可逆，请确认已备份重要数据
#   - 需要docker-compose环境支持
#######################################
echo "正在停止并删除容器服务..."
docker-compose down -v

#######################################
# 数据清理
# 删除内容：
#   - ./data/ 目录（所有持久化数据）
# 安全提示：
#   - 此操作会永久删除所有数据库数据
#   - 确保不再需要这些数据后再执行
#######################################
echo "正在清理数据文件..."
rm -rf data/*

echo -e "\n卸载完成！"
echo "验证结果："
echo "剩余容器：$(docker ps -a --filter 'name=rabbitmq|mysql|redis|nacos' -q | wc -l)"
echo "剩余数据目录：$(ls -d data 2>/dev/null | wc -l)"